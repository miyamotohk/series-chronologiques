myarima = auto.arima(ts.ey)
summary(myarima)
# Plot model data and real data
ts.arimafit = ts(myarima$fitted, start=c(1960,1), end=c(2019,3), frequency=12)
par(mfrow=c(1,1))
png(file='./Figures/Figure20.png', width=480, height=350)
ts.plot(ts.ey, ts.arimafit, gpars = list(ylab='Earning yield', col=c("black", "red"), lty=c("solid", "dotted")), main="Earning yield original et issue de l'ARIMA")
legend(x=2000, y=0.14, legend=c("Original data", "Fitted data"), col=c("black", "red"), lty=c("solid", "dotted"), cex=0.8)
dev.off()
# Question 11
# Prediction for 3 periods
prediction = predict(myarima, 3, interval="confidence")
ts.pred = ts(prediction$pred, start=c(2019,4), frequency=12)
myforecast = forecast(myarima, level = c(95), h = 3)
par(mfrow=c(1,1))
png(file='./Figures/Figure21.png', width=480, height=350)
plot(myforecast, include=250, main="Prédiction ARIMA")
dev.off()
plot(myforecast, include=50, main="Prédiction ARIMA")
ts.actual = window(ts.ey, start=c(2018,4), end=c(2019,3), frequency=12)
arima1 = arima(window(ts.ey, end=c(2018,3)), order=c(1,1,2))
arima2 = arima(window(ts.ey, end=c(2018,3)), order=c(1,1,1))
arima3 = arima(window(ts.ey, end=c(2018,3)), order=c(6,1,3))
pred1 = predict(arima1, 12)
pred2 = predict(arima2, 12)
pred3 = predict(arima3, 12)
#png(file='./Figures/Figure22.png', width=480, height=350)
ts.plot(ts.actual, pred1$pred, pred2$pred, gpars = list(ylab='Earning yield',
col=c("black", "red", "blue")), main="Earning yield original et issue de l'ARIMA")
#png(file='./Figures/Figure22.png', width=480, height=350)
ts.plot(ts.actual, pred1$pred, pred2$pred, pred3$pred, gpars = list(ylab='Earning yield',
col=c("black", "red", "blue", "purple")), main="Earning yield original et issue de l'ARIMA")
legend(x=2018.8, y=0.052, legend=c("Ground truth", "ARIMA(1,1,2)", "ARIMA(1,1,1), ARIMA(6,1,3)"),
col=c("black", "red", "blue", "purple"), lty=c(1,1,1), cex=0.8)
legend(x=2018.8, y=0.052, legend=c("Ground truth", "ARIMA(1,1,2)", "ARIMA(1,1,1)", "ARIMA(6,1,3)"),
col=c("black", "red", "blue", "purple"), lty=c(1,1,1), cex=0.8)
#png(file='./Figures/Figure22.png', width=480, height=350)
ts.plot(ts.actual, pred1$pred, pred2$pred, pred3$pred, gpars = list(ylab='Earning yield',
col=c("black", "red", "blue", "purple")), main="Earning yield original et issue de l'ARIMA")
legend(x=2018.8, y=0.052, legend=c("Ground truth", "ARIMA(1,1,2)", "ARIMA(1,1,1)", "ARIMA(6,1,3)"),
col=c("black", "red", "blue", "purple"), lty=c(1,1,1), cex=0.8)
#png(file='./Figures/Figure22.png', width=480, height=350)
ts.plot(ts.actual, pred1$pred, pred2$pred, pred3$pred, gpars = list(ylab='Earning yield',
col=c("black", "red", "blue", "purple")), main="Prédictions de l'earning yield")
legend(x=2018.8, y=0.052, legend=c("Ground truth", "ARIMA(1,1,2)", "ARIMA(1,1,1)", "ARIMA(6,1,3)"),
col=c("black", "red", "blue", "purple"), lty=c(1,1,1), cex=0.8)
mae(ts.actual, pred1$pred)
rmse(ts.actual, pred1$pred)
mae(ts.actual, pred2$pred)
rmse(ts.actual, pred2$pred)
mae(ts.actual, pred3$pred)
rmse(ts.actual, pred3$pred)
for (year in 1960:10:2010){
print(paste("The year is", year))
}
# Question 13
# Sliding method
for (year in 1960:2010:10){
print(paste("The year is", year))
}
# Question 13
# Sliding method
for (year in seq(from=1960, to=2010, by=10)){
print(paste("The year is", year))
}
years = seq(from=1960, to=2010, by=10))
for (year in years){
print(paste("The year is", year))
}
years
# Question 13
# Sliding method
years <- seq(from=1960, to=2010, by=10))
# Question 13
# Sliding method
years = seq(from=1960, to=2010, by=10)
for (year in years){
print(paste("The year is", year))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(year+10,12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(year+10,12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(year,12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(10+year,12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(10+year,12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year+10))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
future = year+10
ey.aux = window(ts.ey, start=c(year,1), end=c(future,12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year+10))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(year,12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year+10))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(year+1,12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year+10))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2019),12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year+10))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year+10))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
#r.aux = window(ts.r, start=c(year,1), end=c(year+10,12), frequency=12)
#ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year))
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
print(paste("The year is", year))
}
ls.model$coefficients
ls.model$coefficients[1]
ls.model$coefficients[0]
ls.model$coefficients[1]
ls.model$coefficients[2]
beta = []
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c(beta, ls.model$coefficients[2])
}
plot(beta)
plot(years, beta)
beta
as.double(1)
as.double(beta)
beta = c(beta, as.double(ls.model$coefficients[2]))
beta = []
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c(beta, as.double(ls.model$coefficients[2]))
}
View(beta)
View(beta)
beta = []
i = 0
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta[i] = ls.model$coefficients[2]
i = i + 1
}
View(beta)
View(beta)
beta
beta = []
i = 0
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta[i] = 0
i = i + 1
}
beta
beta = numeric(0)
i = 0
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta[i] = 0
i = i + 1
}
beta
beta = numeric(0)
i = 0
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta[i] = ls.model$coefficients[2]
i = i + 1
}
bet
beta
plot(years, beta)
years
beta = numeric(0)
i = 0
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
print(i)
beta[i] = ls.model$coefficients[2]
i = i + 1
}
beta[0]
beta = numeric(0)
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
print(i)
beta = c(beta, ls.model$coefficients[2])
}
beta
plot(years, beta)
plot(years, beta, lyt="l")
plot(years, beta, lty="l")
plot(years, beta, type="l")
plot(years, beta, type="l", main="Évolution de beta_r")
ls.model
ls.model = lm(ey.aux ~ r.aux)
ls.model
ls.model = lm(ey.aux ~ r.aux, interval="confidence")
ls.model = lm(ey.aux ~ r.aux, interval="confidence")
ls.model$coefficients
summary(ls.model)
vcov(ls.model)
diag(vcov(ls.model))
sqrt(diag(vcov(ls.model)))
sqrt(diag(vcov(ls.model)))[1]
sqrt(diag(vcov(ls.model)))[2]
beta = numeric(0)
ubeta = numeric(0)
lbeta = numeric(0)
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux, interval="confidence")
print(i)
beta = c(beta, ls.model$coefficients[2])
ubeta = c(beta, ls.model$coefficients[2] + 1.96*sqrt(diag(vcov(ls.model)))[2])
lbeta = c(beta, ls.model$coefficients[2] - 1.96*sqrt(diag(vcov(ls.model)))[2])
}
beta
ubeta
lbeta
vcov(ls.model)
vcov(ls.model)[2,2]
sqrt(vcov(ls.model)[2,2])
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux, interval="confidence")
print(i)
beta = c(beta, ls.model$coefficients[2])
ubeta = c( beta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( beta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
print(i)
beta = c(beta, ls.model$coefficients[2])
ubeta = c( beta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( beta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
beta
beta
ubeta
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c( beta, ls.model$coefficients[2] )
ubeta = c( beta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( beta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
beta
beta = numeric(0)
ubeta = numeric(0)
lbeta = numeric(0)
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c( beta, ls.model$coefficients[2] )b
ubeta = c( beta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( beta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
# Question 13
# Sliding method
beta = numeric(0)
ubeta = numeric(0)
lbeta = numeric(0)
years = seq(from=1960, to=2010, by=10)
for (year in years) {
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c( beta, ls.model$coefficients[2] )b
ubeta = c( beta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( beta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c( beta, ls.model$coefficients[2] )b
ubeta = c( beta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( beta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
years = seq(from=1960, to=2010, by=10)
for (year in years){
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c( beta, ls.model$coefficients[2] )
ubeta = c( beta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( beta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
beta
ubeta
lbeta
beta = numeric(0)
ubeta = numeric(0)
lbeta = numeric(0)
years = seq(from=1960, to=2010, by=10)
for (year in years){
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c( beta, ls.model$coefficients[2] )
ubeta = c( ubeta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( lbeta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
beta
ubeta
lbeta
ts.plot(beta)
ts.beta = ts(beta, start=(1,1960), end=(1,2010), frequency=1)
ts.beta = ts(beta, start=(1,1960), end=(1,2010), frequency=1)
ts.beta = ts(beta, start=(1960,1), end=(2010,1), frequency=1)
ts.beta = ts(beta, start=c(1960,1), end=c(2010,1), frequency=1)
ts.plot(ts.beta, ts.ubeta, ts.lbeta)
ts.plot(ts.beta, ts.ubeta, ts.lbeta)
ts.beta = ts(beta, start=c(1960,1), end=c(2010,1), frequency=1)
ts.ubeta = ts(ubeta, start=c(1960,1), end=c(2010,1), frequency=1)
ts.lbeta = ts(lbeta, start=c(1960,1), end=c(2010,1), frequency=1)
ts.plot(ts.beta, ts.ubeta, ts.lbeta)
ts.beta = ts(beta, start=c(1960), end=c(2010), frequency=1)
ts.ubeta = ts(ubeta, start=c(1960), end=c(2010), frequency=1)
ts.lbeta = ts(lbeta, start=c(1960), end=c(2010), frequency=1)
ts.plot(ts.beta, ts.ubeta, ts.lbeta)
ts.plot(beta, ubeta, lbeta)
ts.plot(beta, ubeta, lbeta)
function (x, y, ...)
plot(years, beta, type="l", main="Évolution de beta_r")
beta = numeric(0)
ubeta = numeric(0)
lbeta = numeric(0)
years = seq(from=1960, to=2010, by=10)
for (year in years){
print(paste("The year is", year))
ey.aux = window(ts.ey, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
r.aux = window(ts.r, start=c(year,1), end=c(min(year+10,2018),12), frequency=12)
ls.model = lm(ey.aux ~ r.aux)
beta = c( beta, ls.model$coefficients[2] )
ubeta = c( ubeta, ls.model$coefficients[2] + 1.96*sqrt(vcov(ls.model)[2,2]) )
lbeta = c( lbeta, ls.model$coefficients[2] - 1.96*sqrt(vcov(ls.model)[2,2]) )
}
plot(years, beta, type="l", main="Évolution de beta_r")
plot(years, beta, type="l", main="Évolution de beta_r")
lines(years, lbeta, col="red", lty=2)
lines(years, lbeta, col="red", lty=2)
plot(years, beta, type="l", main="Évolution de beta_r")
lines(years, ubeta, col="red", lty=2)
lines(years, lbeta, col="red", lty=2)
plot(years, beta, type="l", main="Évolution de beta_r")
lines(years, ubeta, lty=2)
lines(years, lbeta, lty=2)
plot(years, beta, type="l", ylim=c(-1,1), main="Évolution de beta_r")
plot(years, beta, type="l", ylim=c(-0.1,0.1), main="Évolution de beta_r")
lines(years, ubeta, lty=2)
lines(years, lbeta, lty=2)
plot(years, beta, type="l", ylim=c(-0.01,0.01), main="Évolution de beta_r")
plot(years, beta, type="l", ylim=c(-0.01,0.01), main="Évolution de beta_r")
lines(years, ubeta, lty=2)
lines(years, lbeta, lty=2)
plot(years, beta, type="l", ylim=c(-0.005,0.015), main="Évolution de beta_r")
lines(years, ubeta, lty=2)
lines(years, lbeta, lty=2)
plot(years, beta, type="l", ylim=c(-0.01,0.015), main="Évolution de beta_r")
lines(years, ubeta, lty=2)
lines(years, lbeta, lty=2)
install.packages("strucchange")
library('strucchange')
# Question 14
cumsum(ts.ey)
# Question 14
plot(cumsum(ts.ey))
# Question 14
plot(cumsum.test(ts.ey))
# Question 14
cumsum.test(ts.ey)
# Question 14
cumsum.test(ts.ey)
# Question 14
cumsum.test(ey)
# Question 14
cumsum.test(ts.ey)
# Question 14
cumsum(ts.ey)
# Question 14
cumsum.test(ts.ey)
# Question 14
cusum.test(ts.ey)
install.packages('CPAT')
library('CPAT')
# Question 14
cusum.test(ts.ey)
# Question 14
CUSUM.test(ts.ey)
? efp
# Question 14
efp(ts.ey ~ ts.r)
# Question 14
efp(formula = ts.ey ~ ts.r)
# Question 14
summary(efp(formula = ts.ey ~ ts.r))
# Question 14
cusum = efp(formula = ts.ey ~ ts.r)
summary(cusum)
plot(cusum)
sctest(cusum)
summary(cusum)
# Clear workspace
rm(list = ls())
source('~/Documentos/CentraleSupélec/3ème année/Séries chronologiques/TP/series-chronologiques/SCH.R', echo=TRUE)
